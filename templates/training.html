{% extends "base.html" %}

{% block title %}Training{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='train.css') }}">
{% endblock %}

{% block content %}
<h1>Режим тренировки</h1>

<div class="condition">
    <h2>{{ task.title }}</h2>
    <p>{{ task.statement }}</p>
    <p>Лимит времени: {{ task.time_limit }}</p>
    <p>Лимит памяти: {{ task.memory_limit }}</p>
</div>

<div class="Input">
    <p>{{ task.input_format }}</p>
    <p>{{ task.output_format }}</p>
</div>

<div class="examples">
    <div class="example">
        <p><strong>Input</strong></p>
        <pre>{{ test.input_data }}</pre>
    </div>

    <div class="example">
        <p><strong>Output</strong></p>
        <pre>{{ test.output }}</pre>
    </div>
</div>

<p>Вердикт: {{ verdict }}</p>

{% if test_passed is not none %}
    <p>Пройдено тестов: {{ test_passed }}</p>
{% endif %}

<div class="task">
    <form class="send" method="post" enctype="multipart/form-data" id="uploadForm">
        <input type="file" accept=".py" name="file" id="pythonFile" required />
        <button type="submit" id="submitBtn">Отправить</button>
    </form>
</div>
{% endblock %}
{% block scripts %}
<script>
document.getElementById('uploadForm').addEventListener('submit', function (event) {
    const fileInput = document.getElementById('pythonFile')

    if (!fileInput.files || fileInput.files.length === 0) {
        event.preventDefault()
        alert('Пожалуйста, выберите файл.')
        return false
    }

    const file = fileInput.files[0]
    const fileExtension = file.name.split('.').pop().toLowerCase()

    if (fileExtension !== 'py') {
        event.preventDefault()
        alert('Допускаются только файлы с расширением .py')
        return false
    }

    if (file.size > 1024 * 1024) {
        event.preventDefault()
        alert('Файл слишком большой. Максимальный размер: 1MB')
        return false
    }

    return true
})
</script>
{% endblock %}
